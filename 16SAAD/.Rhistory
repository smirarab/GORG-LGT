require(ggplot2);require(scales)
require(chngpt)
d = read.table("combined_data.txt",header=T)
# S16
fitd16=chngptm(formula.1=qdistAstral16-qdist16~1, formula.2=~pdist, data=d , type="stegmented",
family="gaussian")
ggplot(d,aes(x=pdist,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="blue") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() + xlab("mean pairwise AAD") + ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="blue") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() + xlab("mean pairwise AAD") + ylab("quartet distance (adjusted)")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
fitd16
fitd16$chngpt
with(fitd16[pdist<fitd16$chngpt,qdistAstral16-qdist16]
)
with(fitd16[fitd16$pdist<fitd16$chngpt,qdistAstral16-qdist16])
with(fitd16[fitd16$pdist<fitd16$chngpt,],qdistAstral16-qdist16)
with(fitd16[fitd16$pdist<fitd16$chngpt,],)
with(fitd16[fitd16$pdist<fitd16$chngpt,])
with(fitd16[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)
with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)
with(d[d$pdist<fitd16$chngpt,],t.test(qdistAstral16-qdist16))
?t.test
with(d[d$pdist<fitd16$chngpt,],t.test(qdistAstral16,qdist16))
with(d[d$pdist<fitd16$chngpt,],t.test(qdistAstral16-qdist16))
fitd16
with(d[d$pdist<fitd16$chngpt,],t.test(qdistAstral16-qdist16))
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16))
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)-
with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))
t.test(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16))
t.test(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))
with(d[d$pdist<fitd16$chngpt,],t.test(qdistAstral16-qdist16))
fitd16
require(ggplot2);require(scales)
require(chngpt)
ggplot(d,aes(x=pdist,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="blue") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() + xlab("mean pairwise AAD") + ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="blue") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="blue") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2030AA") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#1030AA") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#103099") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("quartet distance (adjusted)")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("quartet distance (adjusted)")
t.test(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))
with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)
mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.3,geom="text",label=pate("mean:",mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))))
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.3,geom="text",label=paste("mean:",mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))))
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.3,geom="text",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),2)))
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.3,geom="text",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.25,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.4,y=.25,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.25,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.1,y=.45,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.25,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.18,y=.5,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=.25,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.19,y=.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
?test
?test
?t.test
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16),with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16))
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16),with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16),
alternative ="greater")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
install.packages("ggsignif")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance") + geom_line(data = arc.df, aes(Group+1.5, Value+11), lty = 2) +
geom_text(x = 1.5, y = 12, label = "***")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance") +
annotate(x=0.2,xend = 0.4,geom="line",color="red") +
geom_text(x = 1.5, y = 12, label = "***")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance") +
annotate(x=0.2,xend = 0.4,geom="segment",color="red") +
geom_text(x = 1.5, y = 12, label = "***")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance") +
annotate(x=0.2,xend = 0.4,y=0.51,yend=0.51,geom="segment",color="red") +
geom_text(x = 1.5, y = 12, label = "***")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.2,xend = 0.4,y=0.49,yend=0.49,geom="segment",color="red") +
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance") +
geom_text(x = 1.5, y = 12, label = "***")
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16),with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16),
alternative ="greater")
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16),with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16),
alternative ="greater")$p.value
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.2,xend = 0.4,y=0.49,yend=0.49,geom="segment",color="red") +
annotate(x=.2,y=0.51,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.2,xend = 0.4,y=0.48,yend=0.48,geom="segment",color="red") +
annotate(x=.3,y=0.46,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
t.test(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16),with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16),
alternative ="greater")
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.2,y=0.51,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.2,xend = 0.4,y=0.48,yend=0.48,geom="segment",color="red") +
annotate(x=.3,y=0.46,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.15,xend = 0.4,y=0.49,yend=0.49,geom="segment",color="red") +
annotate(x=.3,y=0.47,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.1,xend = 0.45,y=0.49,yend=0.49,geom="segment",color="red") +
annotate(x=.3,y=0.47,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.49,yend=0.49,geom="segment",color="red") +
annotate(x=.3,y=0.47,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.49,yend=0.49,geom="segment",color="red") +
annotate(x=.26,y=0.47,geom="text",color="red",label="****")+
scale_x_continuous("mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.52,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.49,yend=0.49,geom="segment",color="red") +
annotate(x=.26,y=0.47,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.5,yend=0.5,geom="segment",color="red") +
annotate(x=.26,y=0.48,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.53,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.5,yend=0.5,geom="segment",color="red") +
annotate(x=.26,y=0.48,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.5,yend=0.51,geom="segment",color="red") +
annotate(x=.26,y=0.49,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.5,yend=0.52,geom="segment",color="red") +
annotate(x=.26,y=0.49,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.52,yend=0.52,geom="segment",color="red") +
annotate(x=.26,y=0.49,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.51,yend=0.51,geom="segment",color="red") +
annotate(x=.26,y=0.49,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.54,geom="text",color="red",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.51,yend=0.51,geom="segment",color="red") +
annotate(x=.26,y=0.48,geom="text",color="red",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
ggplot(d,aes(x=pdist/100,y=qdistAstral16-qdist16)) +
geom_point(alpha=1/3,color="#2E3F80") +
geom_hline(yintercept = 0,linetype=2) +
geom_smooth(aes(group = pdist<fitd16[[2]][5]),method="lm",se=F,color="red")+
theme_classic() +
annotate(x=.4,y=0.54,geom="text",color="black",label=paste("mean:",round(mean(with(d[d$pdist>=fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=.15,y=0.54,geom="text",color="black",label=paste("mean:",round(mean(with(d[d$pdist<fitd16$chngpt,],qdistAstral16-qdist16)),3)))+
annotate(x=0.12,xend = 0.43,y=0.51,yend=0.51,geom="segment",color="black") +
annotate(x=.26,y=0.48,geom="text",color="black",label="****")+
scale_x_continuous("Mean pairwise amino acid difference",labels=percent) +
ylab("Adjusted quartet distance")
ggsave("astral_vs_S16.pdf",width=7,height = 4)
